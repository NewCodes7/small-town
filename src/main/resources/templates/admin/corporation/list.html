<!DOCTYPE html>
<html lang="ko" xmlns:th="http://www.thymeleaf.org" xmlns:layout="http://www.ultraq.net.nz/thymeleaf/layout"
      layout:decorate="~{layout/base}">
<section layout:fragment="content">
    <div class="container mt-4">
        <!-- Header Section -->
        <div class="hero-section text-center mb-5">
            <h1 class="hero-title">
                <i class="fas fa-building me-3" style="color: var(--primary-green);"></i>
                기업 관리
            </h1>
            <p class="hero-subtitle">기술 블로그를 운영하는 기업들을 관리하고 추가할 수 있어요</p>
        </div>
        
        <!-- 성공/에러 메시지 -->
        <div th:if="${successMessage}" class="alert alert-success" role="alert">
            <i class="fas fa-check-circle me-2"></i>
            <span th:text="${successMessage}"></span>
        </div>
        <div th:if="${errorMessage}" class="alert alert-danger" role="alert">
            <i class="fas fa-exclamation-triangle me-2"></i>
            <span th:text="${errorMessage}"></span>
        </div>
        
        <!-- 검색 및 등록 버튼 -->
        <div class="card mb-4" style="border-radius: 20px; background: var(--white);">
            <div class="card-body p-4">
                <div class="row align-items-center">
                    <div class="col-md-8">
                        <form th:action="@{/admin/corporations}" method="get" class="d-flex">
                            <div class="input-group">
                                <span class="input-group-text" style="background: var(--secondary-green); border: 2px solid var(--border-light); color: var(--primary-green-dark);">
                                    <i class="fas fa-search"></i>
                                </span>
                                <input type="text" name="search" th:value="${search}" class="form-control" placeholder="기업명을 검색해보세요" style="border-left: none;">
                                <button type="submit" class="btn btn-secondary">검색</button>
                            </div>
                        </form>
                    </div>
                    <div class="col-md-4 text-end">
                        <a th:href="@{/admin/corporations/new}" class="btn btn-primary">
                            <i class="fas fa-plus me-2"></i>기업 등록
                        </a>
                    </div>
                </div>
            </div>
        </div>
        
        <!-- 기업 목록 -->
        <div class="row g-5" th:if="${!corporations.content.isEmpty()}">
            <div class="col-lg-6 col-xl-4" th:each="corp : ${corporations.content}">
                <div class="card h-100 corporation-card">
                    <div class="card-body p-4">
                        <!-- Company Header -->
                        <div class="d-flex align-items-center mb-4">
                            <div class="company-avatar me-3">
                                <img th:if="${corp.logoUrl}" th:src="${corp.logoUrl}" alt="logo" style="width: 44px; height: 44px; object-fit: contain; border-radius: 10px;">
                                <i th:unless="${corp.logoUrl}" class="fas fa-building fa-lg" style="color: var(--primary-green);"></i>
                            </div>
                            <div class="flex-grow-1">
                                <h5 class="mb-1 fw-bold" style="color: var(--text-dark);" th:text="${corp.name}">Company Name</h5>
                                <small class="text-muted">
                                    <i class="fas fa-calendar me-1"></i>
                                    <span th:text="${#temporals.format(corp.createdAt, 'yyyy-MM-dd')}">2024-01-01</span>
                                </small>
                            </div>
                            <div class="dropdown">
                                <button class="btn btn-sm" style="background: none; border: none; color: var(--text-light);" data-bs-toggle="dropdown">
                                    <i class="fas fa-ellipsis-v"></i>
                                </button>
                                <ul class="dropdown-menu">
                                    <li><a class="dropdown-item" th:href="@{'/admin/corporations/' + ${corp.id} + '/edit'}">
                                        <i class="fas fa-edit me-2"></i>수정
                                    </a></li>
                                    <li><hr class="dropdown-divider"></li>
                                    <li>
                                        <form th:action="@{'/admin/corporations/' + ${corp.id} + '/delete'}" method="post" style="margin: 0;">
                                            <button type="submit" class="dropdown-item text-danger" 
                                                    onclick="return confirm('정말 삭제하시겠습니까?')">
                                                <i class="fas fa-trash me-2"></i>삭제
                                            </button>
                                        </form>
                                    </li>
                                </ul>
                            </div>
                        </div>
                        
                        <!-- Industries -->
                        <div class="mb-3" th:if="${!corp.industries.isEmpty()}">
                            <span class="badge tag-badge me-1 mb-1" 
                                  th:each="industry : ${corp.industries}"
                                  th:text="${industry}">Industry</span>
                        </div>
                        
                        <!-- Links -->
                        <div class="d-flex gap-2 mt-auto">
                            <a th:if="${corp.blogLink}" th:href="${corp.blogLink}" target="_blank" 
                               class="btn btn-sm flex-fill" 
                               style="background: var(--secondary-green); color: var(--primary-green-dark); font-weight: 600; border-radius: 12px;">
                                <i class="fas fa-blog me-1"></i>블로그
                            </a>
                            <a th:if="${corp.homeLink}" th:href="${corp.homeLink}" target="_blank" 
                               class="btn btn-sm btn-secondary flex-fill">
                                <i class="fas fa-home me-1"></i>홈페이지
                            </a>
                            <a th:if="${corp.crewLink}" th:href="${corp.crewLink}" target="_blank" 
                               class="btn btn-sm btn-secondary flex-fill">
                                <i class="fas fa-users me-1"></i>채용
                            </a>
                        </div>
                    </div>
                </div>
            </div>
        </div>
        
        <!-- Empty State -->
        <div th:if="${corporations.content.isEmpty()}" class="text-center py-5">
            <div class="hero-section">
                <i class="fas fa-building fa-4x mb-4" style="color: var(--primary-green); opacity: 0.5;"></i>
                <h4 class="mb-3" style="color: var(--text-dark); font-weight: 700;">등록된 기업이 없어요</h4>
                <p class="text-muted mb-4">처음 기업을 등록해보세요!</p>
                <a th:href="@{/admin/corporations/new}" class="btn btn-primary">
                    <i class="fas fa-plus me-2"></i>첫 번째 기업 등록하기
                </a>
            </div>
        </div>
        
        <!-- 페이징 -->
        <nav th:if="${corporations.totalPages > 1}" class="mt-5">
            <ul class="pagination justify-content-center">
                <li class="page-item" th:classappend="${corporations.first} ? 'disabled'">
                    <a class="page-link" th:href="@{/admin/corporations(page=0, search=${search})}">
                        <i class="fas fa-angles-left me-1"></i>처음
                    </a>
                </li>
                <li class="page-item" th:classappend="${!corporations.hasPrevious()} ? 'disabled'">
                    <a class="page-link" th:href="@{/admin/corporations(page=${corporations.number - 1}, search=${search})}">
                        <i class="fas fa-chevron-left me-1"></i>이전
                    </a>
                </li>
                <li class="page-item" 
                    th:each="i : ${#numbers.sequence(T(java.lang.Math).max(0, corporations.number - 2), T(java.lang.Math).min(corporations.totalPages - 1, corporations.number + 2))}" 
                    th:classappend="${i == corporations.number} ? 'active'">
                    <a class="page-link" th:href="@{/admin/corporations(page=${i}, search=${search})}" th:text="${i + 1}"></a>
                </li>
                <li class="page-item" th:classappend="${!corporations.hasNext()} ? 'disabled'">
                    <a class="page-link" th:href="@{/admin/corporations(page=${corporations.number + 1}, search=${search})}">
                        다음<i class="fas fa-chevron-right ms-1"></i>
                    </a>
                </li>
                <li class="page-item" th:classappend="${corporations.last} ? 'disabled'">
                    <a class="page-link" th:href="@{/admin/corporations(page=${corporations.totalPages - 1}, search=${search})}">
                        마지막<i class="fas fa-angles-right ms-1"></i>
                    </a>
                </li>
            </ul>
        </nav>
    </div>
</section>
</html>